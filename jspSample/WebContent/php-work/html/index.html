<?php
//세션 검사 해서 세션 값이 있으면 홈페이지로 이동
session_start();
if(!empty($_SESSION['org_cd']))
{
header('Location:main.html');
}
?>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <meta name="description" content="">
    <meta name="author" content="">
   
    <title>My CheckUP Reservation Admin</title>

    <!-- Bootstrap core CSS -->
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="../admin/signin.css" rel="stylesheet">

    <!--JQuery js -->
    <script src="../assets/js/jquery.min.js"></script>
     <script src="../assets/js/jquery.ui.shake.js"></script>
    <script src="../assets/js/jquery.dropotron.min.js"></script>
    <script src="../assets/js/bootstrap.min.js"></script>
    
        <script>
            $(document).ready(function(){
                $('button').click(function(){
                var loginID=$("#loginID").val();
                var password=$("#inputPassword").val();
                var dataString = 'loginID='+loginID+'&password='+password;

                 if($.trim(loginID).length>0 && $.trim(password).length>0)
                  {
                     $.ajax({
                            type: "POST",
                            url: "php/loginProcess.php",
                            data: dataString,
                            cache: false,
                            //beforeSend: function(){ $("#login").val('Connecting...');},
                            dataType: "json",
                            async: true,
                            success: resultProcess,
                            
                            error: function(request,status,error){
                                    alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
                                         }
                            
                            }); //End of ajax
                             function resultProcess(data){
                                             var result=data['result'];  //data는 json객체
                                              if(result=="true")
                                              {   
                                             
                                              $(location).attr('href','main.html');
                                              
                                              //console.log(data['h_name']);
                                              sessionStorage.h_name=data['h_name'];
                                              sessionStorage.org_cd=data['org_cd'];
                                              }
                                               else
                                              {
                                         
                                              $('#box').shake();
                                        
                                              $("#error").html("<div class='panel-body'><h4>아이디와 비번이 틀립니다.</h4></div>");
                                          
                                              var allReset=function(){
                                                $("#LoginForm").each(function() {  
                                                  this.reset();  
                                                });

                                                $("#error").hide()
                                                }
                                                setTimeout(allReset, 1000);
                                                }
                                 }  //End of Callback Fuction           
            
                    }
                  return false;
                  }); //End of button
            
                    //섹션 저장   
                             if(localStorage.chkbx && localStorage.chkbx != '') {
                                   $('#remember_me').attr('checked', 'checked');
                                   $('#loginID').val(localStorage.usrname);
                                   $('#inputPassword').val(localStorage.pass);
                               }else{
                                   $('#loginID').removeAttr('checked');
                                   $('#loginID').val('');
                                   $('#inputPassword').val('');
                              }
                  
              
                              $('#remember_me').click(function(){
                                 if ($('#remember_me').is(':checked')) {
                                     // save username and password
                                     console.log("Remember me checked")
                                     localStorage.usrname = $('#loginID').val();
                                     localStorage.pass = $('#inputPassword').val();
                                     localStorage.chkbx = $('#remember_me').val();
                                     console.log(localStorage.chkbx);
                                  }else{
                                     localStorage.usrname = '';
                                     localStorage.pass = '';
                                     localStorage.chkbx = '';
                                  }
                               });
                

            });
        
        </script>



    </head>

  <body>
  <div id="main">
    <div id="box" class="container">
    <form id="LoginForm" class="form-signin" method="post" action="">
        <h2 class="form-signin-heading">MyCheckUP Admin</h2>
        <label for="loginID" class="sr-only">로그인 ID</label>
        <input type="text" name="loginID" id="loginID" class="form-control" placeholder="아이디를 입력하세요" required autofocus>
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" name="password" id="inputPassword" class="form-control" placeholder="Password" required>
        <div class="checkbox">
          <label>
            <input type="checkbox" id="remember_me">Remember me
          </label>
        </div>
        <button class="btn btn-lg btn-primary btn-block" type="submit" id="login">로그인</button>
        <div class="panel panel-default" id="error">
         </div>  
      </form>
     
    </div> <!-- /container -->

    

</div> <!--/main -->



    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->
  </body>
</html>
